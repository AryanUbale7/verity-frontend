<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login & Sign Up - Verity AI</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');

        /* --- Global Reset --- */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }

        body {
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; background-color: #f0f2f5; overflow: hidden;
        }

        /* --- Back Button --- */
        .back-home {
            position: fixed; top: 30px; left: 30px; display: flex; align-items: center; gap: 10px;
            text-decoration: none; color: #1f2937; font-weight: 700; background: white;
            padding: 10px 20px; border-radius: 50px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 1000; transition: 0.3s;
        }
        .back-home:hover { transform: translateX(-5px); color: #2563eb; }

        /* --- Main Container --- */
        .container {
            position: relative; width: 850px; height: 550px;
            background-color: #fff; border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; max-width: 95vw;
        }

        .form-container { position: absolute; top: 0; height: 100%; transition: all 0.6s ease-in-out; }
        .sign-in-container { left: 0; width: 50%; z-index: 2; }
        .sign-up-container { left: 0; width: 50%; opacity: 0; z-index: 1; }

        .container.right-panel-active .sign-in-container { transform: translateX(100%); }
        .container.right-panel-active .sign-up-container {
            transform: translateX(100%); opacity: 1; z-index: 5; animation: show 0.6s;
        }

        @keyframes show {
            0%, 49.99% { opacity: 0; z-index: 1; }
            50%, 100% { opacity: 1; z-index: 5; }
        }

        form {
            background-color: #ffffff; display: flex; align-items: center;
            justify-content: center; flex-direction: column; padding: 0 40px;
            height: 100%; text-align: center;
        }

        h1 { font-weight: 800; margin-bottom: 10px; color: #111827; font-size: 24px; }
        span { font-size: 12px; color: #64748b; margin-bottom: 15px; }
        
        /* Google Button Wrapper */
        .google-wrapper { margin: 15px 0; min-height: 40px; }

        input {
            background-color: #f9fafb; border: 1px solid #e5e7eb;
            padding: 12px 15px; margin: 6px 0; width: 100%; border-radius: 10px; outline: none;
        }

        .btn-main {
            border-radius: 10px; border: 1px solid #2563eb; background-color: #2563eb;
            color: #ffffff; font-size: 14px; font-weight: 700; padding: 12px 45px;
            margin-top: 15px; cursor: pointer; transition: 0.2s; width: 100%;
        }

        .ghost { background-color: transparent; border-color: #ffffff; color: white; width: auto; }

        /* --- Overlay --- */
        .overlay-container {
            position: absolute; top: 0; left: 50%; width: 50%; height: 100%;
            overflow: hidden; transition: transform 0.6s ease-in-out; z-index: 100;
        }
        .container.right-panel-active .overlay-container { transform: translateX(-100%); }

        .overlay {
            background: linear-gradient(to right, #1d4ed8, #2563eb);
            color: #ffffff; position: relative; left: -100%; height: 100%; width: 200%;
            transform: translateX(0); transition: transform 0.6s ease-in-out;
        }
        .container.right-panel-active .overlay { transform: translateX(50%); }

        .overlay-panel {
            position: absolute; display: flex; align-items: center; justify-content: center;
            flex-direction: column; padding: 0 40px; text-align: center; top: 0; height: 100%;
            width: 50%; transition: transform 0.6s ease-in-out;
        }
        .overlay-left { transform: translateX(-20%); }
        .container.right-panel-active .overlay-left { transform: translateX(0); }
        .overlay-right { right: 0; transform: translateX(0); }
        .container.right-panel-active .overlay-right { transform: translateX(20%); }

        .overlay-panel h1 { color: white; }
    </style>
</head>
<body>

    <a href="index.html" class="back-home">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
        Back to Home
    </a>

    <div id="g_id_onload"
         data-client_id="923692705298-4i5tg969um71fgrdvnats35u9kcpkmbl.apps.googleusercontent.com"
         data-context="signin"
         data-ux_mode="popup"
         data-callback="handleCredentialResponse"
         data-auto_prompt="false">
    </div>

    <div class="container" id="container">
        <div class="form-container sign-up-container">
            <form action="#">
                <h1>Create Account</h1>
                <div class="google-wrapper">
                    <div class="g_id_signin" data-type="standard" data-shape="pill" data-theme="outline" data-text="signup_with" data-size="large" data-logo_alignment="left"></div>
                </div>
                <span>or use your email for registration</span>
                <input type="text" placeholder="Full Name" />
                <input type="email" placeholder="Email" />
                <input type="password" placeholder="Password" />
                <button class="btn-main" type="button" onclick="window.location.href='try-verity.html'">Sign Up</button>
            </form>
        </div>

        <div class="form-container sign-in-container">
            <form action="#">
                <h1>Sign in</h1>
                <div class="google-wrapper">
                    <div class="g_id_signin" data-type="standard" data-shape="pill" data-theme="outline" data-text="signin_with" data-size="large" data-logo_alignment="left"></div>
                </div>
                <span>or use your account</span>
                <input type="email" placeholder="Email" id="loginEmail" />
                <input type="password" placeholder="Password" id="loginPass" />
                <a href="#" style="margin: 10px 0; color: #64748b; font-size: 12px; text-decoration: none;">Forgot your password?</a>
                <button class="btn-main" type="button" onclick="window.location.href='try-verity.html'">Sign In</button>
            </form>
        </div>

        <div class="overlay-container">
            <div class="overlay">
                <div class="overlay-panel overlay-left">
                    <h1>Welcome Back!</h1>
                    <p>To keep connected with us please login with your personal info</p>
                    <button class="btn-main ghost" id="signIn">Sign In</button>
                </div>
                <div class="overlay-panel overlay-right">
                    <h1>Hello, Friend!</h1>
                    <p>Enter your personal details and start journey with us</p>
                    <button class="btn-main ghost" id="signUp">Sign Up</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Toggle Logic
        const signUpButton = document.getElementById('signUp');
        const signInButton = document.getElementById('signIn');
        const container = document.getElementById('container');

        signUpButton.addEventListener('click', () => {
            container.classList.add("right-panel-active");
        });

        signInButton.addEventListener('click', () => {
            container.classList.remove("right-panel-active");
        });

        // Google Auth Logic
        function handleCredentialResponse(response) {
    const responsePayload = decodeJwtResponse(response.credential);

    // Data local storage mein save karein
    localStorage.setItem('userName', responsePayload.name);
    localStorage.setItem('userImg', responsePayload.picture);
    localStorage.setItem('isLoggedIn', 'true'); // Login status track karne ke liye
    
    // Ab ye Home Page par bhejega
    window.location.href = "index.html";
}
        function decodeJwtResponse(token) {
            var base64Url = token.split('.')[1];
            var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            var jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function(c) {
                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
            }).join(''));
            return JSON.parse(jsonPayload);
        }
    </script>
    <script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbzCVr8B1zhE4qwHKvN6gHWUIJEDVMDBdArWOJ1eyWOuITR2E1kJDTGvimtJIQST5a0H/exec';

function handleCredentialResponse(response) {
    // 1. User Data Nikalo
    const user = decodeJwtResponse(response.credential);
    console.log("User Info:", user);

    // 2. Local Storage Update Karo (Instant UI ke liye)
    localStorage.setItem('authToken', response.credential);
    localStorage.setItem('userName', user.name);
    localStorage.setItem('userPic', user.picture);
    localStorage.setItem('userEmail', user.email);

    // 3. Google Sheet Data Bhejo (Background Mein)
    // âœ… NOTE: 'await' hata diya hai taaki rukna na pade
    fetch(scriptURL, {
        method: 'POST',
        mode: 'no-cors',
        keepalive: true, // ðŸ”¥ YE ZAROORI HAI: Page change hone par bhi data bhejta rahega
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            name: user.name,
            email: user.email,
            picture: user.picture
        })
    });

    // 4. TURANT Redirect Karo (Bina Intezaar Kiye)
    window.location.href = "index.html";
}

// Decoder function waisa hi rahega
function decodeJwtResponse(token) {
    var base64Url = token.split('.')[1];
    var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
    var jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function(c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(''));
    return JSON.parse(jsonPayload);
}
</script>
</body>
</html>